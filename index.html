<!DOCTYPE html>
<html lang="pt-br" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Benai App | Central</title>
    
    <!-- LIBS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&family=Space+Grotesk:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- CONFIGURAÇÃO TAILWIND -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        mono: ['Space Grotesk', 'monospace'],
                    },
                    colors: {
                        brand: {
                            dark: '#0f172a',
                            light: '#e0f2fe',
                            accent: '#0ea5e9', // Sky 500
                            glow: '#38bdf8'    // Sky 400
                        }
                    },
                    animation: {
                        'float': 'float 10s infinite ease-in-out',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0) scale(1)' },
                            '50%': { transform: 'translateY(-20px) scale(1.05)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* BASE & BACKGROUND */
        body {
            transition: background-color 0.5s ease, color 0.5s ease;
            background-attachment: fixed;
        }
        
        /* ORBS ANIMATION */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.5;
            animation: float 15s infinite alternate;
        }

        /* GLASSMORPHISM CARDS */
        .glass-card {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }
        
        .dark .glass-card {
            background: rgba(15, 23, 42, 0.6); /* Slate 900 com transparência */
            border: 1px solid rgba(56, 189, 248, 0.15); /* Sky Blue border sutil */
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        /* HOVER EFFECTS */
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .hover-lift:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px -5px rgba(14, 165, 233, 0.25);
            border-color: rgba(56, 189, 248, 0.5);
        }
        .hover-lift:active { transform: scale(0.96); }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #38bdf8; border-radius: 4px; }

        /* PIN INPUT */
        .pin-digit {
            font-family: 'Space Grotesk', monospace;
            letter-spacing: 0.5em;
            text-align: center;
        }

        /* LOGO B */
        .logo-b {
            background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
            box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.5);
        }
    </style>
</head>
<body class="bg-sky-50 text-slate-800 dark:bg-[#0b1121] dark:text-sky-50 min-h-screen selection:bg-sky-400 selection:text-white overflow-x-hidden">

    <!-- BACKGROUND ANIMATION (Lighter/Blueish) -->
    <div class="orb w-[500px] h-[500px] bg-sky-300/30 dark:bg-blue-600/20 top-[-10%] left-[-10%]"></div>
    <div class="orb w-[400px] h-[400px] bg-cyan-300/30 dark:bg-cyan-600/20 bottom-[10%] right-[-5%] animation-delay-2000"></div>
    <div class="orb w-[300px] h-[300px] bg-indigo-300/30 dark:bg-indigo-600/20 top-[40%] left-[30%] animation-delay-4000"></div>

    <!-- GATEKEEPER (Lock Screen) -->
    <div id="gatekeeper" class="fixed inset-0 z-[9999] flex flex-col items-center justify-center bg-sky-50/90 dark:bg-[#0b1121]/95 backdrop-blur-xl transition-all duration-700">
        <div class="text-center space-y-8 animate-float">
            <!-- Logo Grande -->
            <div class="w-24 h-24 mx-auto rounded-3xl logo-b flex items-center justify-center rotate-3 hover:rotate-0 transition-transform duration-500">
                <span class="font-mono text-6xl font-bold text-white tracking-tighter">B.</span>
            </div>
            
            <div>
                <h1 class="text-3xl font-bold tracking-tight mb-1 font-sans">BENAI APP</h1>
                <p class="text-slate-500 dark:text-sky-400/70 text-xs uppercase tracking-[0.3em] font-bold">Acesso Seguro</p>
            </div>

            <div class="relative group">
                <input type="password" id="pinInput" maxlength="8" class="pin-digit w-64 bg-transparent border-b-2 border-slate-300 dark:border-sky-900 text-2xl focus:outline-none focus:border-sky-500 transition-colors py-3 text-center" placeholder="••••••••" autofocus inputmode="numeric">
                <div id="pinError" class="absolute -bottom-8 left-0 right-0 text-red-500 text-xs font-bold opacity-0 transition-opacity">PIN INCORRETO</div>
            </div>
        </div>
    </div>

    <!-- APP CONTAINER -->
    <div id="app-container" class="max-w-5xl mx-auto px-6 py-10 opacity-0 transition-opacity duration-1000 flex flex-col items-center">
        
        <!-- HEADER CENTRALIZADO -->
        <header class="text-center mb-16 relative w-full flex flex-col items-center">
            
            <!-- Settings & Theme Buttons (Absolute Positioned for Desktop, relative for mobile layout adjust if needed) -->
            <div class="absolute right-0 top-0 flex gap-3">
                <button onclick="toggleTheme()" class="w-10 h-10 rounded-full glass-card flex items-center justify-center hover:bg-white/50 dark:hover:bg-sky-900/50 transition">
                    <i id="themeIcon" data-lucide="moon" class="w-5 h-5 text-slate-600 dark:text-sky-300"></i>
                </button>
                <button onclick="openSettings()" class="w-10 h-10 rounded-full glass-card flex items-center justify-center hover:bg-white/50 dark:hover:bg-sky-900/50 transition relative">
                    <div id="syncIndicator" class="absolute top-0 right-0 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white dark:border-slate-900"></div>
                    <i data-lucide="settings-2" class="w-5 h-5 text-slate-600 dark:text-sky-300"></i>
                </button>
            </div>

            <!-- Main Identity -->
            <div class="w-20 h-20 rounded-2xl logo-b flex items-center justify-center mb-6 shadow-2xl shadow-blue-500/20">
                <span class="font-mono text-5xl font-bold text-white tracking-tighter">B.</span>
            </div>
            
            <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight mb-2 text-transparent bg-clip-text bg-gradient-to-r from-sky-600 to-blue-600 dark:from-sky-300 dark:to-blue-400">BENAI APP</h1>
            <p class="text-sm md:text-base font-medium text-slate-500 dark:text-sky-200/60 tracking-[0.2em] uppercase">Sistema de Gestão Pessoal</p>
            
            <div id="dateDisplay" class="mt-4 px-4 py-1.5 rounded-full bg-sky-100/50 dark:bg-sky-900/30 text-sky-700 dark:text-sky-300 text-xs font-bold uppercase tracking-wide border border-sky-200 dark:border-sky-700/50">
                Carregando data...
            </div>
        </header>

        <!-- MAIN CONTENT (SECTIONS) -->
        <div class="w-full space-y-12">

            <!-- SEÇÃO 1: VIDA PESSOAL -->
            <section class="animate-fade-in" style="animation-delay: 100ms;">
                <div class="flex items-center justify-center gap-4 mb-8">
                    <div class="h-px bg-gradient-to-r from-transparent via-sky-300 dark:via-sky-700 to-transparent w-24"></div>
                    <h2 class="text-lg font-bold text-slate-700 dark:text-sky-100 uppercase tracking-widest flex items-center gap-2">
                        <i data-lucide="heart" class="w-4 h-4 text-sky-500"></i> Vida Pessoal
                    </h2>
                    <div class="h-px bg-gradient-to-r from-transparent via-sky-300 dark:via-sky-700 to-transparent w-24"></div>
                </div>

                <!-- Atualizado para suportar 5 itens responsivamente -->
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <!-- Tracker -->
                    <a href="tracker.html" class="glass-card rounded-2xl p-5 hover-lift flex flex-col items-center text-center group">
                        <div class="w-12 h-12 rounded-xl bg-emerald-100 dark:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i data-lucide="check-circle-2" class="w-6 h-6"></i>
                        </div>
                        <h3 class="font-bold text-slate-700 dark:text-white">Tracker</h3>
                        <p class="text-[10px] uppercase font-bold text-slate-400 dark:text-slate-400 mt-1">Hábitos & Metas</p>
                    </a>

                    <!-- Financeiro -->
                    <a href="financeiro.html" class="glass-card rounded-2xl p-5 hover-lift flex flex-col items-center text-center group">
                        <div class="w-12 h-12 rounded-xl bg-violet-100 dark:bg-violet-500/20 text-violet-600 dark:text-violet-400 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i data-lucide="pie-chart" class="w-6 h-6"></i>
                        </div>
                        <h3 class="font-bold text-slate-700 dark:text-white">Financeiro</h3>
                        <p class="text-[10px] uppercase font-bold text-slate-400 dark:text-slate-400 mt-1">Gestão de Gastos</p>
                    </a>

                    <!-- Cartão -->
                    <a href="cartao.html" class="glass-card rounded-2xl p-5 hover-lift flex flex-col items-center text-center group">
                        <div class="w-12 h-12 rounded-xl bg-amber-100 dark:bg-amber-500/20 text-amber-600 dark:text-amber-400 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i data-lucide="credit-card" class="w-6 h-6"></i>
                        </div>
                        <h3 class="font-bold text-slate-700 dark:text-white">Cartão C6</h3>
                        <p class="text-[10px] uppercase font-bold text-slate-400 dark:text-slate-400 mt-1">Limites e Faturas</p>
                    </a>

                    <!-- Dieta -->
                    <a href="dieta.html" class="glass-card rounded-2xl p-5 hover-lift flex flex-col items-center text-center group">
                        <div class="w-12 h-12 rounded-xl bg-rose-100 dark:bg-rose-500/20 text-rose-600 dark:text-rose-400 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i data-lucide="apple" class="w-6 h-6"></i>
                        </div>
                        <h3 class="font-bold text-slate-700 dark:text-white">Dieta</h3>
                        <p class="text-[10px] uppercase font-bold text-slate-400 dark:text-slate-400 mt-1">Plano Alimentar</p>
                    </a>

                    <!-- Viagens (NOVO) -->
                    <a href="viagens.html" class="glass-card rounded-2xl p-5 hover-lift flex flex-col items-center text-center group">
                        <div class="w-12 h-12 rounded-xl bg-fuchsia-100 dark:bg-fuchsia-500/20 text-fuchsia-600 dark:text-fuchsia-400 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i data-lucide="plane" class="w-6 h-6"></i>
                        </div>
                        <h3 class="font-bold text-slate-700 dark:text-white">Viagens</h3>
                        <p class="text-[10px] uppercase font-bold text-slate-400 dark:text-slate-400 mt-1">Controle & Roteiros</p>
                    </a>
                </div>
            </section>

            <!-- SEÇÃO 2: CONSULTORIA -->
            <section class="animate-fade-in" style="animation-delay: 200ms;">
                <div class="flex items-center justify-center gap-4 mb-8">
                    <div class="h-px bg-gradient-to-r from-transparent via-sky-300 dark:via-sky-700 to-transparent w-24"></div>
                    <h2 class="text-lg font-bold text-slate-700 dark:text-sky-100 uppercase tracking-widest flex items-center gap-2">
                        <i data-lucide="dumbbell" class="w-4 h-4 text-sky-500"></i> Consultoria
                    </h2>
                    <div class="h-px bg-gradient-to-r from-transparent via-sky-300 dark:via-sky-700 to-transparent w-24"></div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-2 gap-4 max-w-2xl mx-auto">
                    <!-- Gerador -->
                    <a href="gerador.html" class="glass-card rounded-2xl p-6 hover-lift flex items-center gap-4 group">
                        <div class="w-12 h-12 rounded-xl bg-indigo-100 dark:bg-indigo-500/20 text-indigo-600 dark:text-indigo-400 flex items-center justify-center shrink-0">
                            <i data-lucide="zap" class="w-6 h-6"></i>
                        </div>
                        <div class="text-left">
                            <h3 class="font-bold text-slate-700 dark:text-white">Gerador</h3>
                            <p class="text-[10px] uppercase font-bold text-slate-400 dark:text-slate-400 mt-0.5">Criar Treinos</p>
                        </div>
                    </a>

                    <!-- Aluno -->
                    <a href="aluno.html" class="glass-card rounded-2xl p-6 hover-lift flex items-center gap-4 group">
                        <div class="w-12 h-12 rounded-xl bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 flex items-center justify-center shrink-0">
                            <i data-lucide="users" class="w-6 h-6"></i>
                        </div>
                        <div class="text-left">
                            <h3 class="font-bold text-slate-700 dark:text-white">Portal Aluno</h3>
                            <p class="text-[10px] uppercase font-bold text-slate-400 dark:text-slate-400 mt-0.5">Área do Cliente</p>
                        </div>
                    </a>
                </div>
            </section>

            <!-- SEÇÃO 3: TRABALHO -->
            <section class="animate-fade-in" style="animation-delay: 300ms;">
                <div class="flex items-center justify-center gap-4 mb-8">
                    <div class="h-px bg-gradient-to-r from-transparent via-sky-300 dark:via-sky-700 to-transparent w-24"></div>
                    <h2 class="text-lg font-bold text-slate-700 dark:text-sky-100 uppercase tracking-widest flex items-center gap-2">
                        <i data-lucide="briefcase" class="w-4 h-4 text-sky-500"></i> Trabalho
                    </h2>
                    <div class="h-px bg-gradient-to-r from-transparent via-sky-300 dark:via-sky-700 to-transparent w-24"></div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-3xl mx-auto">
                    <!-- Fit Studio -->
                    <a href="fit_studio.html" class="glass-card rounded-2xl p-6 hover-lift flex flex-col justify-center group relative overflow-hidden">
                        <div class="relative z-10 flex items-center gap-4">
                            <div class="w-14 h-14 rounded-xl bg-orange-100 dark:bg-orange-500/20 text-orange-600 dark:text-orange-400 flex items-center justify-center shrink-0">
                                <i data-lucide="layout" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-slate-800 dark:text-white">Fit Studio</h3>
                                <p class="text-xs uppercase font-bold text-slate-400 dark:text-slate-400 mt-1">Gestão de Sala & Horários</p>
                            </div>
                        </div>
                    </a>

                    <!-- PRIME ACQUAFIT (DESTAQUE) -->
                    <a href="prime.html" class="glass-card rounded-2xl p-6 hover-lift flex flex-col justify-center group relative overflow-hidden border-sky-500/30 dark:border-sky-500/30">
                        <div class="absolute inset-0 bg-gradient-to-r from-sky-500/5 to-blue-500/5 dark:from-sky-500/10 dark:to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                        <div class="relative z-10 flex items-center gap-4">
                            <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-sky-400 to-blue-600 text-white flex items-center justify-center shrink-0 shadow-lg shadow-sky-500/20">
                                <i data-lucide="gem" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-slate-800 dark:text-white">Prime Acquafit</h3>
                                <p class="text-xs uppercase font-bold text-sky-600 dark:text-sky-300 mt-1 flex items-center gap-1">
                                    Acessar Sistema <i data-lucide="arrow-right" class="w-3 h-3"></i>
                                </p>
                            </div>
                        </div>
                    </a>
                </div>
            </section>

        </div>

        <footer class="mt-20 text-center text-[10px] text-slate-400/60 font-mono tracking-widest uppercase">
            Benai OS v3.2 • Secure Connection
        </footer>
    </div>

    <!-- SETTINGS MODAL (Right Side Panel) -->
    <div id="settingsModal" class="fixed inset-0 z-50 bg-slate-900/20 dark:bg-black/60 backdrop-blur-sm hidden" onclick="if(event.target === this) closeSettings()">
        <div class="absolute right-0 top-0 bottom-0 w-full max-w-sm bg-white dark:bg-[#0f172a] border-l border-slate-200 dark:border-slate-800 shadow-2xl p-6 transform transition-transform translate-x-full duration-300 flex flex-col" id="settingsPanel">
            
            <div class="flex justify-between items-center mb-8 pb-4 border-b border-slate-100 dark:border-slate-800">
                <h2 class="text-xl font-bold font-sans dark:text-white">Configurações</h2>
                <button onclick="closeSettings()" class="p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full dark:text-white"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>

            <div class="space-y-8 flex-1 overflow-y-auto">
                
                <!-- TOKEN -->
                <div>
                    <label class="block text-xs font-bold uppercase text-slate-400 mb-2 tracking-wider">GitHub Token (Global)</label>
                    <div class="relative">
                        <input type="password" id="globalToken" class="w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl p-3 pl-10 text-xs font-mono focus:ring-2 focus:ring-sky-500 outline-none dark:text-white" placeholder="ghp_...">
                        <div class="absolute left-3 top-3">
                            <i data-lucide="key" class="w-4 h-4 text-slate-400"></i>
                        </div>
                    </div>
                    <button onclick="saveToken()" class="mt-2 w-full py-2 text-xs font-bold text-sky-600 dark:text-sky-400 bg-sky-50 dark:bg-sky-900/20 rounded-lg hover:bg-sky-100 dark:hover:bg-sky-900/40 transition">SALVAR TOKEN</button>
                </div>

                <!-- CLOUD ACTIONS -->
                <div class="p-5 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-200 dark:border-slate-700">
                    <h3 class="text-sm font-bold flex items-center gap-2 mb-2 dark:text-white"><i data-lucide="cloud" class="w-4 h-4 text-sky-500"></i> Backup Global</h3>
                    <p class="text-[10px] text-slate-500 dark:text-slate-400 mb-4 leading-relaxed">Sincronize todos os dados de todos os aplicativos de uma só vez.</p>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="cloudBackupAll()" class="flex flex-col items-center justify-center gap-1 py-3 bg-sky-600 text-white rounded-xl font-bold text-[10px] hover:bg-sky-700 transition shadow-lg shadow-sky-500/20">
                            <i data-lucide="upload-cloud" class="w-4 h-4"></i> ENVIAR TUDO
                        </button>
                        <button onclick="cloudRestoreAll()" class="flex flex-col items-center justify-center gap-1 py-3 bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 dark:text-white rounded-xl font-bold text-[10px] hover:bg-slate-50 dark:hover:bg-slate-600 transition">
                            <i data-lucide="download-cloud" class="w-4 h-4"></i> BAIXAR TUDO
                        </button>
                    </div>
                </div>

                <!-- DANGER ZONE -->
                <div class="pt-4 border-t border-slate-100 dark:border-slate-800">
                    <button onclick="if(confirm('Isso desconectará sua sessão. Continuar?')){sessionStorage.clear(); location.reload()}" class="w-full py-3 border border-red-200 dark:border-red-900/30 text-red-500 rounded-xl font-bold text-xs hover:bg-red-50 dark:hover:bg-red-900/10 transition flex items-center justify-center gap-2">
                        <i data-lucide="lock" class="w-3 h-3"></i> BLOQUEAR TERMINAL
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-slate-900 dark:bg-white text-white dark:text-slate-900 px-6 py-3 rounded-full font-bold shadow-2xl translate-y-20 opacity-0 transition-all duration-300 z-[100] flex items-center gap-3 whitespace-nowrap border border-white/10">
        <i data-lucide="info" class="w-4 h-4 text-sky-400 dark:text-sky-600"></i>
        <span id="toastMsg" class="text-xs">Notificação</span>
    </div>

    <script>
        // CONFIG
        const PIN = "16359001";
        const GIST_DESC_GLOBAL = "BENAI_FULL_BACKUP_V3";
        const TOKEN_KEY = "BENAI_GLOBAL_TOKEN";

        // INIT
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            checkGatekeeper();
            updateDate();
            lucide.createIcons();
            
            // Check Global Token Status for Indicator
            if(localStorage.getItem(TOKEN_KEY)) {
                document.getElementById('syncIndicator').classList.remove('bg-red-500');
                document.getElementById('syncIndicator').classList.add('bg-emerald-500');
                document.getElementById('globalToken').value = localStorage.getItem(TOKEN_KEY);
            }
        });

        // --- GATEKEEPER ---
        function checkGatekeeper() {
            if(sessionStorage.getItem('benai_auth') === 'true') {
                unlockUI();
            } else {
                const input = document.getElementById('pinInput');
                input.focus();
                input.addEventListener('keyup', (e) => {
                    if(e.target.value.length === 8) {
                        if(e.target.value === PIN) {
                            sessionStorage.setItem('benai_auth', 'true');
                            unlockUI();
                        } else {
                            const err = document.getElementById('pinError');
                            err.style.opacity = '1';
                            e.target.classList.add('text-red-500', 'border-red-500');
                            setTimeout(() => {
                                e.target.value = '';
                                e.target.classList.remove('text-red-500', 'border-red-500');
                                err.style.opacity = '0';
                            }, 1000);
                        }
                    }
                });
            }
        }

        function unlockUI() {
            const gate = document.getElementById('gatekeeper');
            const app = document.getElementById('app-container');
            
            gate.style.opacity = '0';
            gate.style.pointerEvents = 'none';
            
            setTimeout(() => {
                app.style.opacity = '1';
            }, 500);
        }

        // --- THEME ---
        function initTheme() {
            if (localStorage.getItem('theme') === 'light') {
                document.documentElement.classList.remove('dark');
                document.getElementById('themeIcon').setAttribute('data-lucide', 'sun');
            }
        }

        function toggleTheme() {
            const html = document.documentElement;
            const icon = document.getElementById('themeIcon');
            
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                icon.replaceWith(icon.cloneNode(true));
                document.getElementById('themeIcon').setAttribute('data-lucide', 'sun');
            } else {
                html.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                document.getElementById('themeIcon').setAttribute('data-lucide', 'moon');
            }
            lucide.createIcons();
        }

        // --- DATE ---
        function updateDate() {
            const now = new Date();
            const options = { weekday: 'long', day: 'numeric', month: 'long' };
            document.getElementById('dateDisplay').innerText = now.toLocaleDateString('pt-BR', options);
        }

        // --- SETTINGS UI ---
        function openSettings() {
            const modal = document.getElementById('settingsModal');
            const panel = document.getElementById('settingsPanel');
            modal.classList.remove('hidden');
            setTimeout(() => panel.classList.remove('translate-x-full'), 10);
        }

        function closeSettings() {
            const modal = document.getElementById('settingsModal');
            const panel = document.getElementById('settingsPanel');
            panel.classList.add('translate-x-full');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            const m = document.getElementById('toastMsg');
            m.innerText = msg;
            t.classList.remove('translate-y-20', 'opacity-0');
            setTimeout(() => t.classList.add('translate-y-20', 'opacity-0'), 3000);
        }

        // --- CLOUD SYNC LOGIC (GLOBAL) ---
        function saveToken() {
            const val = document.getElementById('globalToken').value.trim();
            if(val) {
                localStorage.setItem(TOKEN_KEY, val);
                document.getElementById('syncIndicator').classList.replace('bg-red-500', 'bg-emerald-500');
                showToast('Token Global Salvo!');
            }
        }

        async function cloudBackupAll() {
            const token = localStorage.getItem(TOKEN_KEY);
            if(!token) return showToast('Configure o Token primeiro!');

            showToast('Iniciando Backup Global...');

            const backupData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                backupData[key] = localStorage.getItem(key);
            }

            try {
                const gists = await fetch('https://api.github.com/gists', {
                    headers: { 'Authorization': `token ${token}` }
                }).then(r => r.json());

                const existing = gists.find(g => g.description === GIST_DESC_GLOBAL);
                
                const payload = {
                    description: GIST_DESC_GLOBAL,
                    public: false,
                    files: { "benai_full_backup.json": { content: JSON.stringify(backupData) } }
                };

                let url = 'https://api.github.com/gists';
                let method = 'POST';

                if(existing) {
                    url += '/' + existing.id;
                    method = 'PATCH';
                }

                const res = await fetch(url, {
                    method: method,
                    headers: { 'Authorization': `token ${token}` },
                    body: JSON.stringify(payload)
                });

                if(res.ok) showToast('Backup Global Concluído!');
                else throw new Error('Falha');

            } catch(e) {
                console.error(e);
                showToast('Erro ao salvar na nuvem');
            }
        }

        async function cloudRestoreAll() {
            const token = localStorage.getItem(TOKEN_KEY);
            if(!token) return showToast('Configure o Token primeiro!');

            if(!confirm('Isso substituirá TODOS os dados locais pelos da nuvem. Continuar?')) return;

            showToast('Buscando dados...');

            try {
                const gists = await fetch('https://api.github.com/gists', {
                    headers: { 'Authorization': `token ${token}` }
                }).then(r => r.json());

                const backupGist = gists.find(g => g.description === GIST_DESC_GLOBAL);
                if(!backupGist) return showToast('Nenhum backup encontrado.');

                const fileUrl = backupGist.files['benai_full_backup.json'].raw_url;
                const data = await fetch(fileUrl).then(r => r.json());

                Object.keys(data).forEach(key => localStorage.setItem(key, data[key]));

                showToast('Sistema Restaurado! Recarregando...');
                setTimeout(() => location.reload(), 1500);

            } catch(e) {
                console.error(e);
                showToast('Erro ao restaurar');
            }
        }
    </script>
</body>
</html>
